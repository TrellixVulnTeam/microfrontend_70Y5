{"ast":null,"code":"import _regeneratorRuntime from \"/Users/charles/Documents/MicroFrontEnd/bistro2.0/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _toConsumableArray from \"/Users/charles/Documents/MicroFrontEnd/bistro2.0/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _asyncToGenerator from \"/Users/charles/Documents/MicroFrontEnd/bistro2.0/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.parse-int.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport shop from '../api/shop';\n\nvar state = function state() {\n  return {\n    items: [],\n    checkoutStatus: null\n  };\n};\n\nvar getters = {\n  getCartProducts: function getCartProducts(state, getters, rootState) {\n    var providerProducts = rootState.products.allProducts;\n    var cartProducts = [];\n    state.items.forEach(function (item) {\n      var product = providerProducts.find(function (product) {\n        return product._id === item._id;\n      });\n      cartProducts.push({\n        '_id': item._id,\n        'nameProduct': product.nameProduct,\n        'price': product.price,\n        'quantity': item.quantity\n      });\n    });\n    return cartProducts;\n  },\n  cartTotalPrice: function cartTotalPrice(state, getters, rootState) {\n    var cartProducts = getters.getCartProducts;\n    var total = 0;\n    cartProducts.forEach(function (product) {\n      total += parseInt(product.price) * parseInt(product.quantity);\n    });\n    return total;\n  }\n};\nvar actions = {\n  checkout: function checkout(_ref, products) {\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var commit, state, savedCartItems;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              commit = _ref.commit, state = _ref.state;\n              savedCartItems = _toConsumableArray(state.items);\n              commit('setCheckoutStatus', null);\n              commit('setCartItems', {\n                items: []\n              });\n              _context.prev = 4;\n              _context.next = 7;\n              return shop.buyProducts(products);\n\n            case 7:\n              commit('setCheckoutStatus', 'succesful');\n              _context.next = 15;\n              break;\n\n            case 10:\n              _context.prev = 10;\n              _context.t0 = _context[\"catch\"](4);\n              console.error(_context.t0);\n              commit('setCheckoutStatus', 'failed');\n              commit('setCartItems', {\n                items: savedCartItems\n              });\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[4, 10]]);\n    }))();\n  },\n  addProductToCart: function addProductToCart(_ref2, product) {\n    var state = _ref2.state,\n        commit = _ref2.commit;\n    var cartProduct = null;\n    var productInventory;\n    var itemQuantity;\n    state.items.forEach(function (item) {\n      if (product._id === item._id) {\n        cartProduct = product;\n        productInventory = product.inventory;\n        itemQuantity = item.quantity;\n      }\n    });\n\n    if (cartProduct === null) {\n      commit('pushProductToCart', product);\n    } else if (itemQuantity < productInventory) {\n      commit('incrementItemQuantity', product);\n    }\n  },\n  deleteOneFromCart: function deleteOneFromCart(_ref3, itemToDelete) {\n    var state = _ref3.state,\n        commit = _ref3.commit;\n\n    if (itemToDelete.quantity > 1) {\n      commit('decrementItemQuantity', itemToDelete);\n    } else {\n      commit('deleteCartItem', itemToDelete);\n    }\n  },\n  deleteAllFromCart: function deleteAllFromCart(_ref4, product) {\n    var state = _ref4.state,\n        commit = _ref4.commit;\n    commit('deleteCartItem', product);\n  }\n};\nvar mutations = {\n  pushProductToCart: function pushProductToCart(state, product) {\n    state.items.push({\n      '_id': product._id,\n      'quantity': 1\n    });\n  },\n  incrementItemQuantity: function incrementItemQuantity(state, product) {\n    var cartItem = state.items.find(function (item) {\n      return item._id === product._id;\n    });\n    cartItem.quantity++;\n  },\n  decrementItemQuantity: function decrementItemQuantity(state, itemToDelete) {\n    var cartItem = state.items.find(function (item) {\n      return item._id === itemToDelete._id;\n    });\n    cartItem.quantity--;\n  },\n  deleteCartItem: function deleteCartItem(state, itemToDelete) {\n    var index = null;\n\n    for (var i = 0; i < state.items.length; i++) {\n      if (state.items[i].id === itemToDelete.id) {\n        index = i;\n      }\n    }\n\n    state.items.splice(index, 1);\n  },\n  setCartItems: function setCartItems(state, _ref5) {\n    var items = _ref5.items;\n    state.items = items;\n  },\n  setCheckoutStatus: function setCheckoutStatus(state, status) {\n    state.checkoutStatus = status;\n  }\n};\nexport default {\n  namespaced: true,\n  state: state,\n  getters: getters,\n  actions: actions,\n  mutations: mutations\n};","map":{"version":3,"names":["shop","state","items","checkoutStatus","getters","getCartProducts","rootState","providerProducts","products","allProducts","cartProducts","forEach","item","product","find","_id","push","nameProduct","price","quantity","cartTotalPrice","total","parseInt","actions","checkout","commit","savedCartItems","buyProducts","console","error","addProductToCart","cartProduct","productInventory","itemQuantity","inventory","deleteOneFromCart","itemToDelete","deleteAllFromCart","mutations","pushProductToCart","incrementItemQuantity","cartItem","decrementItemQuantity","deleteCartItem","index","i","length","id","splice","setCartItems","setCheckoutStatus","status","namespaced"],"sources":["/Users/charles/Documents/MicroFrontEnd/bistro2.0/src/Cart/cart.js"],"sourcesContent":["import shop from '../api/shop'\n\nconst state = () => ({\n    items : [],\n    checkoutStatus: null\n})\n\nconst getters = {\n    getCartProducts(state, getters, rootState) {\n        const providerProducts = rootState.products.allProducts\n        const cartProducts = []\n        state.items.forEach(item => {\n            const product = providerProducts.find(product => product._id === item._id)\n            cartProducts.push({\n                '_id' : item._id,\n                'nameProduct' : product.nameProduct,\n                'price' : product.price,\n                'quantity' : item.quantity\n            })\n        });\n        return cartProducts\n    },\n\n    cartTotalPrice(state, getters, rootState) {\n        const cartProducts = getters.getCartProducts\n        var total = 0\n        cartProducts.forEach(product => {\n            total += parseInt(product.price) * parseInt(product.quantity)\n        })\n        return total\n    }\n}\n\nconst actions = {\n    async checkout ({commit, state}, products) {\n        const savedCartItems = [...state.items]\n        commit('setCheckoutStatus', null)\n        commit('setCartItems', { items : []})\n        try {\n            await shop.buyProducts(products)\n            commit('setCheckoutStatus', 'succesful')\n        } catch(e) {\n            console.error(e)\n            commit('setCheckoutStatus', 'failed')\n            commit('setCartItems', {items : savedCartItems})\n        }\n    },\n\n    addProductToCart({state, commit}, product) {\n        var cartProduct = null\n        var productInventory\n        var itemQuantity\n        state.items.forEach(item => {\n            if (product._id === item._id) {\n                cartProduct = product\n                productInventory = product.inventory\n                itemQuantity = item.quantity\n            }\n        })\n        if (cartProduct === null) {\n            commit('pushProductToCart', product)\n        } else if (itemQuantity < productInventory) {\n            commit('incrementItemQuantity', product)\n        }\n    },\n\n    deleteOneFromCart({state, commit}, itemToDelete) {\n        if ( itemToDelete.quantity > 1 ) {\n            commit('decrementItemQuantity', itemToDelete)\n        } else {\n            commit('deleteCartItem', itemToDelete)\n        }\n    },\n\n    deleteAllFromCart({state, commit}, product) {\n        commit('deleteCartItem', product)\n    }\n}\n\nconst mutations = {\n    pushProductToCart (state, product) {\n        state.items.push({\n            '_id' : product._id,\n            'quantity' : 1\n        })\n    },\n\n    incrementItemQuantity (state, product) {\n        const cartItem = state.items.find(item => item._id === product._id)\n        cartItem.quantity++\n    },\n\n    decrementItemQuantity (state, itemToDelete) {\n        const cartItem = state.items.find(item => item._id === itemToDelete._id)\n        cartItem.quantity--\n    },\n\n    deleteCartItem (state, itemToDelete) {\n        var index = null\n        for (let i = 0; i < state.items.length; i++) {\n          if(state.items[i].id === itemToDelete.id) {\n            index = i\n          }\n            \n        }\n        state.items.splice(index,1,)\n    },\n\n    setCartItems (state, { items }) {\n        state.items = items\n    },\n\n    setCheckoutStatus (state, status) {\n        state.checkoutStatus = status\n    }\n}\n\nexport default {\n    namespaced: true,\n    state,\n    getters,\n    actions,\n    mutations\n  }"],"mappings":"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"},"metadata":{},"sourceType":"module"}