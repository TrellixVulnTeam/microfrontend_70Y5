{"ast":null,"code":"import shop from '../../api/shop';\n\nconst state = () => ({\n  items: [],\n  checkoutStatus: null\n});\n\nconst getters = {};\nconst actions = {\n  async checkout({\n    commit,\n    state\n  }, products) {\n    const savedCartItems = [...state.items];\n    commit('setCheckoutStatus', null);\n    commit('setCartItems', {\n      items: []\n    });\n\n    try {\n      await shop.buyProducts(products);\n      commit('setCheckoutStatus', 'succesful');\n    } catch (e) {\n      console.error(e);\n      commit('setCheckoutStatus', 'failed');\n      commit('setCartItems', {\n        items: savedCartItems\n      });\n    }\n  },\n\n  addProductToCart({\n    state,\n    commit\n  }, product) {\n    const cartProduct = [state.items.find(item => item.id = product.idProduct)]; //const cartProductLenght = cartProduct.length\n\n    if (cartProduct.lenght) {\n      commit('incrementItemQuantity', product.idProduct);\n    } else {\n      commit('pushProductToCart', product.idProduct);\n    }\n  },\n\n  getCartProducts(state, rootState) {\n    const providerProducts = rootState.products.providerProducts;\n    const cartProducts = [];\n    state.items.forEach(item => {\n      const product = providerProducts.find(product => product.idProduct === item.id);\n      cartProducts.push(product);\n    });\n    return cartProducts;\n  }\n\n};\nconst mutations = {\n  pushProductToCart(state, {\n    id\n  }) {\n    state.items.push({\n      id,\n      quantity: 1\n    });\n  },\n\n  incrementItemQuantity(state, {\n    id\n  }) {\n    const cartItem = state.items.find(item => item.id === id);\n    cartItem.quantity++;\n  },\n\n  setCartItems(state, {\n    items\n  }) {\n    state.items = items;\n  },\n\n  setCheckoutStatus(state, status) {\n    state.checkoutStatus = status;\n  }\n\n};\nexport default {\n  namespaced: true,\n  state,\n  getters,\n  actions,\n  mutations\n};","map":{"version":3,"names":["shop","state","items","checkoutStatus","getters","actions","checkout","commit","products","savedCartItems","buyProducts","e","console","error","addProductToCart","product","cartProduct","find","item","id","idProduct","lenght","getCartProducts","rootState","providerProducts","cartProducts","forEach","push","mutations","pushProductToCart","quantity","incrementItemQuantity","cartItem","setCartItems","setCheckoutStatus","status","namespaced"],"sources":["/Users/charles/Documents/MicroFrontEnd/bistro/src/store/modules/cart.js"],"sourcesContent":["import shop from '../../api/shop'\n\nconst state = () => ({\n    items : [],\n    checkoutStatus: null\n})\n\nconst getters = {\n    \n}\n\nconst actions = {\n    async checkout ({commit, state}, products) {\n        const savedCartItems = [...state.items]\n        commit('setCheckoutStatus', null)\n        commit('setCartItems', { items : []})\n        try {\n            await shop.buyProducts(products)\n            commit('setCheckoutStatus', 'succesful')\n        } catch(e) {\n            console.error(e)\n            commit('setCheckoutStatus', 'failed')\n            commit('setCartItems', {items : savedCartItems})\n        }\n    },\n\n    addProductToCart({state, commit}, product) {\n        const cartProduct = [state.items.find(item => item.id = product.idProduct)]\n        //const cartProductLenght = cartProduct.length\n        if (cartProduct.lenght) {\n            commit('incrementItemQuantity', product.idProduct)\n        } else {\n            commit('pushProductToCart', product.idProduct)\n        }\n    },\n\n    getCartProducts(state, rootState) {\n        const providerProducts = rootState.products.providerProducts\n        const cartProducts = []\n        state.items.forEach(item => {\n            const product = providerProducts.find(product => product.idProduct === item.id)\n            cartProducts.push(product)\n        });\n        return cartProducts\n    }\n}\n\nconst mutations = {\n    pushProductToCart (state, { id }) {\n        state.items.push({\n            id,\n            quantity: 1\n        })\n    },\n\n    incrementItemQuantity (state, { id }) {\n        const cartItem = state.items.find(item => item.id === id)\n        cartItem.quantity++\n    },\n\n    setCartItems (state, { items }) {\n        state.items = items\n    },\n\n    setCheckoutStatus (state, status) {\n        state.checkoutStatus = status\n    }\n}\n\nexport default {\n    namespaced: true,\n    state,\n    getters,\n    actions,\n    mutations\n  }"],"mappings":"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"},"metadata":{},"sourceType":"module"}