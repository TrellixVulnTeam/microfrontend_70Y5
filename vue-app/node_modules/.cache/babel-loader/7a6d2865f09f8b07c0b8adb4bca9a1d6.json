{"ast":null,"code":"import shop from '../../api/shop';\n\nconst state = () => ({\n  items: [],\n  checkoutStatus: null\n});\n\nconst getters = {\n  getCartProducts(state, getters, rootState) {\n    const providerProducts = rootState.products.allProducts;\n    const cartProducts = [];\n    state.items.forEach(item => {\n      const product = providerProducts.find(product => product.idProduct === item.id);\n      cartProducts.push({\n        'id': item.id,\n        'nameProduct': product.nameProduct,\n        'price': product.price,\n        'quantity': item.quantity\n      });\n    });\n    return cartProducts;\n  },\n\n  cartTotalPrice(state, getters, rootState) {\n    const cartProducts = getters.getCartProducts;\n    var total;\n    console.log(\"total\");\n    cartProducts.forEach(product => {\n      console.log(product);\n      total += parseInt(product.price) * parseInt(product.quantity);\n    });\n    return total;\n  }\n\n};\nconst actions = {\n  async checkout({\n    commit,\n    state\n  }, products) {\n    const savedCartItems = [...state.items];\n    commit('setCheckoutStatus', null);\n    commit('setCartItems', {\n      items: []\n    });\n\n    try {\n      await shop.buyProducts(products);\n      commit('setCheckoutStatus', 'succesful');\n    } catch (e) {\n      console.error(e);\n      commit('setCheckoutStatus', 'failed');\n      commit('setCartItems', {\n        items: savedCartItems\n      });\n    }\n  },\n\n  addProductToCart({\n    state,\n    commit\n  }, product) {\n    var cartProduct = null;\n    var productInventory;\n    var itemQuantity;\n    state.items.forEach(item => {\n      if (product.idProduct === item.id) {\n        cartProduct = product;\n        productInventory = product.inventory;\n        itemQuantity = item.quantity;\n      }\n    });\n\n    if (cartProduct === null) {\n      commit('pushProductToCart', product);\n    } else if (itemQuantity < productInventory) {\n      commit('incrementItemQuantity', product);\n    }\n  },\n\n  deleteOneFromCart({\n    state,\n    commit\n  }, itemToDelete) {\n    if (itemToDelete.quantity > 1) {\n      commit('decrementItemQuantity', itemToDelete);\n    } else {\n      commit('deleteCartItem', itemToDelete);\n    }\n  },\n\n  deleteAllFromCart({\n    state,\n    commit\n  }, product) {\n    commit('deleteCartItem', product);\n  }\n\n};\nconst mutations = {\n  pushProductToCart(state, product) {\n    state.items.push({\n      'id': product.idProduct,\n      'quantity': 1\n    });\n  },\n\n  incrementItemQuantity(state, product) {\n    const cartItem = state.items.find(item => item.id === product.idProduct);\n    cartItem.quantity++;\n  },\n\n  decrementItemQuantity(state, itemToDelete) {\n    const cartItem = state.items.find(item => item.id === itemToDelete.id);\n    cartItem.quantity--;\n  },\n\n  deleteCartItem(state, itemToDelete) {\n    var index = null;\n\n    for (let i = 0; i < state.items.length; i++) {\n      if (state.items[i].id === itemToDelete.id) {\n        index = i;\n      }\n    }\n\n    state.items.splice(index, 1);\n  },\n\n  setCartItems(state, {\n    items\n  }) {\n    state.items = items;\n  },\n\n  setCheckoutStatus(state, status) {\n    state.checkoutStatus = status;\n  }\n\n};\nexport default {\n  namespaced: true,\n  state,\n  getters,\n  actions,\n  mutations\n};","map":{"version":3,"names":["shop","state","items","checkoutStatus","getters","getCartProducts","rootState","providerProducts","products","allProducts","cartProducts","forEach","item","product","find","idProduct","id","push","nameProduct","price","quantity","cartTotalPrice","total","console","log","parseInt","actions","checkout","commit","savedCartItems","buyProducts","e","error","addProductToCart","cartProduct","productInventory","itemQuantity","inventory","deleteOneFromCart","itemToDelete","deleteAllFromCart","mutations","pushProductToCart","incrementItemQuantity","cartItem","decrementItemQuantity","deleteCartItem","index","i","length","splice","setCartItems","setCheckoutStatus","status","namespaced"],"sources":["/Users/charles/Documents/MicroFrontEnd/bistro/src/store/modules/cart.js"],"sourcesContent":["import shop from '../../api/shop'\n\nconst state = () => ({\n    items : [],\n    checkoutStatus: null\n})\n\nconst getters = {\n    getCartProducts(state, getters, rootState) {\n        const providerProducts = rootState.products.allProducts\n        const cartProducts = []\n        state.items.forEach(item => {\n            const product = providerProducts.find(product => product.idProduct === item.id)\n            cartProducts.push({\n                'id' : item.id,\n                'nameProduct' : product.nameProduct,\n                'price' : product.price,\n                'quantity' : item.quantity\n            })\n        });\n        return cartProducts\n    },\n\n    cartTotalPrice(state, getters, rootState) {\n        const cartProducts = getters.getCartProducts\n        var total\n        console.log(\"total\")\n        cartProducts.forEach(product => {\n            console.log(product)\n            total += parseInt(product.price) * parseInt(product.quantity)\n        })\n        return total\n    }\n}\n\nconst actions = {\n    async checkout ({commit, state}, products) {\n        const savedCartItems = [...state.items]\n        commit('setCheckoutStatus', null)\n        commit('setCartItems', { items : []})\n        try {\n            await shop.buyProducts(products)\n            commit('setCheckoutStatus', 'succesful')\n        } catch(e) {\n            console.error(e)\n            commit('setCheckoutStatus', 'failed')\n            commit('setCartItems', {items : savedCartItems})\n        }\n    },\n\n    addProductToCart({state, commit}, product) {\n        var cartProduct = null\n        var productInventory\n        var itemQuantity\n        state.items.forEach(item => {\n            if (product.idProduct === item.id) {\n                cartProduct = product\n                productInventory = product.inventory\n                itemQuantity = item.quantity\n            }\n        })\n        if (cartProduct === null) {\n            commit('pushProductToCart', product)\n        } else if (itemQuantity < productInventory) {\n            commit('incrementItemQuantity', product)\n        }\n    },\n\n    deleteOneFromCart({state, commit}, itemToDelete) {\n        if ( itemToDelete.quantity > 1 ) {\n            commit('decrementItemQuantity', itemToDelete)\n        } else {\n            commit('deleteCartItem', itemToDelete)\n        }\n    },\n\n    deleteAllFromCart({state, commit}, product) {\n        commit('deleteCartItem', product)\n    }\n}\n\nconst mutations = {\n    pushProductToCart (state, product) {\n        state.items.push({\n            'id' : product.idProduct,\n            'quantity' : 1\n        })\n    },\n\n    incrementItemQuantity (state, product) {\n        const cartItem = state.items.find(item => item.id === product.idProduct)\n        cartItem.quantity++\n    },\n\n    decrementItemQuantity (state, itemToDelete) {\n        const cartItem = state.items.find(item => item.id === itemToDelete.id)\n        cartItem.quantity--\n    },\n\n    deleteCartItem (state, itemToDelete) {\n        var index = null\n        for (let i = 0; i < state.items.length; i++) {\n          if(state.items[i].id === itemToDelete.id) {\n            index = i\n          }\n            \n        }\n        state.items.splice(index,1,)\n    },\n\n    setCartItems (state, { items }) {\n        state.items = items\n    },\n\n    setCheckoutStatus (state, status) {\n        state.checkoutStatus = status\n    }\n}\n\nexport default {\n    namespaced: true,\n    state,\n    getters,\n    actions,\n    mutations\n  }"],"mappings":"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"},"metadata":{},"sourceType":"module"}